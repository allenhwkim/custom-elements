<!--
  https://material.io/guidelines/components/expansion-panels.html#
-->
<template for="ExpansionPanel">
  <style id="an-expansion-panel-style">
    an-expansion-panel {
      display: block;
      border-radius: 2px;
      z-index: 2;
      background-color: var(--theme-color-0);
      box-shadow: var(--theme-shadow-2dp);
      margin: 16px 0px;
    }
    an-expansion-panel:not([collapsed]) {
      transition: all 450ms var(--theme-animation-ease);
    }

    an-expansion-panel .title {
      position: relative;
      padding: 20px 24px;
      height: 64px;
      cursor: pointer;
    }
    an-expansion-panel .title:after {
      content: '\e5ce';
      display: inline-block;
      position: absolute;
      font-family: 'Material Icons';
      right: 24px;
      font-size: 24px;
    }
    an-expansion-panel .title h1, an-expansion-panel .title h2, an-expansion-panel .title h3 {
      font-size: var(--theme-title-font-size);
      font-weight: var(--theme-title-font-weight);
      margin: 0;
      min-width: 148px;
      font-weight: normal;
      display: inline-block;
    }
    an-expansion-panel .title > div {
      padding-left: 16px;
      display: inline-block;
    }
    an-expansion-panel .title .indicator {
      display: inline-block;
    }

    an-expansion-panel .text {
      padding: 0 24px 16px 24px;
      font-size: 14px;
      color: var(--theme-text-color-700, #444444);
    }

    an-expansion-panel .actions {
      padding: 16px 8px 16px 24px;
      font-size: 14px;
      height: 68px;
      text-align: right;
      line-height: 32px;
    }
    an-expansion-panel .actions > * {
      margin-left: 8px;
      display: inline-block;
      height: 32px;
      line-height: 32px;
    }

    an-expansion-panel[collapsed]:first-child {
      border-radius: 2px 2px 0 0;
    }
    an-expansion-panel[collapsed]:last-child {
      border-radius: 0 0 2px 2px;
    }

    an-expansion-panel[collapsed] {
      border-radius: 0;
      margin: 0;
      border-bottom: 1px solid var(--theme-text-color-100);
      max-height: 48px;
      overflow: hidden;
    }
    an-expansion-panel[collapsed] .title {
      position: relative;
      padding: 0 24px;
      line-height: 48px;
    }
    an-expansion-panel[collapsed] .title:after {
      content: '\e5cf';
    }
    an-expansion-panel[collapsed] .text,
    an-expansion-panel[collapsed] .actions {
      line-height: 0;
      padding: 0;
      overflow: hidden;
    }

  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class ExpansionPanel extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=ExpansionPanel]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.querySelector(`#ce-core-style, #${style.id}`) && document.head.appendChild(style);

      let titleEl = this.querySelector('.title');
      titleEl.addEventListener('click', this._showThisPanelOnly.bind(this));
    }

    connectedCallback() {}
    disconnectedCallback() {}

    _showThisPanelOnly(event) {
      Array.from(document.querySelectorAll('an-expansion-panel')).forEach(panelEl => {
        this.removeAttribute('collapsed');
        !panelEl.isSameNode(this) && panelEl.setAttribute('collapsed','');
      })
    }

  }
  
  customElements.define('an-expansion-panel', ExpansionPanel);
})();
</script>