<template for="CECore">
  <style id="ce-core-style">
  </style>
  <script>
  (function() {
    var thisScript = document.currentScript;
    let template = thisScript.ownerDocument.querySelector('template[for=CECore]');
    let style = template.content.querySelector('style').cloneNode(true);
    !document.getElementById(style.id) && document.head.appendChild(style);
  })();
  </script>
</template>
<template for="AppBar">
  <style id="an-app-bar-style"></style>
</template>
<script>
( function() {
  var thisScript = document.currentScript;

  class AppBar extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=AppBar]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
    }

    connectedCallback() {}
    disconnectedCallback() {}
  }
  
  customElements.define('an-app-bar', AppBar);
})();
</script>
<template for="BottomNavBar">
  <style id="a-bottom-nav-bar-style">
  /**  combined into ce-core */
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class BottomNavBar extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=BottomNavBar]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
    }

    connectedCallback() {}
    disconnectedCallback() {}
  }
  
  customElements.define('a-bottom-nav-bar', BottomNavBar);
})();
</script>
<template for="Card">
  <style id="a-card-style">
  /**  combined into ce-core */
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class Card extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Card]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
    }

    connectedCallback() {}
    disconnectedCallback() {}
  }
  
  customElements.define('a-card', Card);
})();
</script><template for="Chip">
  <style id="a-chip-style">
  /**  combined into ce-core */
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class Chip extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Chip]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
      this._buildHTML();
    }

    connectedCallback() {}
    disconnectedCallback() {}

    _buildHTML() {
      let avatar = this.getAttribute('avatar');
      let text = this.getAttribute('text');
      let removable = this.getAttribute('removable');
      let onRemove = this.getAttribute('on-remove');

      if (avatar) {
        this.insertAdjacentHTML('beforeend', `<div class="avatar">${avatar}</div>`);
      }
      if (text) {
        this.insertAdjacentHTML('beforeend', `<div class="text">${text}</div>`);
      }
      if (removable !== null) {
        let removeEl = document.createElement('div');
        removeEl.classList.add('delete');
        removeEl.setAttribute('md-icon','');
        removeEl.innerHTML = 'clear';

        removeEl.addEventListener('click', event => {
          let customEvent = new CustomEvent('remove', event);
          this.dispatchEvent(customEvent);
        })

        this.appendChild(removeEl);

        this.addEventListener('remove', function(event) {
          let func = new Function(onRemove);
          func();
          this.remove();
        });
      }
    }

  }
  
  customElements.define('a-chip', Chip);
})();
</script>
<template for="Default">
  <style id="custom-elements">
  /**  combined into ce-core */
  </style>
</template>

<script>
(function() {
  var thisScript = document.currentScript;
  let template = thisScript.ownerDocument.querySelector('template[for=Default]');
  let style = template.content.querySelector('style').cloneNode(true);
  !document.getElementById(style.id) && document.head.appendChild(style);
})();
</script><!--
https://material.io/guidelines/components/dialogs.html#dialogs-specs
-->
<template for="Dialog">
  <style id="a-dialog-style">
  /**  combined into ce-core */
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class Dialog extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Dialog]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
      
      this._regroupElements();
      this.originalPos;
    }

    connectedCallback() {}
    disconnectedCallback() {}

    open(data) {
      //replace title, content, actions with data given
      data && this._updateContent(data);

      // move to document-level for z-indexing to work
      this.originalPos = {parent: this.parentElement, nextSibling: this.nextElementSibling};
      document.body.appendChild(this);
      document.body.style.overflow = 'hidden';
      this.setAttribute('visible', '');
    }

    close() {
      // move back to the original position
      this.originalPos.parent.insertBefore(this, this.originalPos.nextSibling);
      document.body.style.overflow = '';
      this.removeAttribute('visible');
    }
 
    _regroupElements() {
      let pageBlockerEl, containerEl;
      pageBlockerEl = document.createElement('div');
      pageBlockerEl.setAttribute('class', 'page-blocker');
      pageBlockerEl.addEventListener('click', () => {
        this.close();
      });
      this.appendChild(pageBlockerEl);

      containerEl = document.createElement('div');
      containerEl.setAttribute('class', 'container');
      this.appendChild(containerEl);

      Array.from(this.children).forEach(el => {
        if (el.tagName !== 'STYLE' && !el.isSameNode(containerEl) && !el.isSameNode(pageBlockerEl)) {
          containerEl.appendChild(el)
        }
      });
    }

    _updateContent(data) {
      let titleEl, contentEl, actionsEl;
      let appendEl = className  => {
        let el = document.createElement('div');
        el.classList.add(className);
        this.appendChild(el);
        return el;
      }
      if (data.title !== undefined) {
        console.log(1, this.querySelector('.title'), this.innerHTML)
        titleEl = this.querySelector('.title') || appendEl('title');
        titleEl.innerHTML = data.title;
      }
      if (data.contents !== undefined) {
        console.log(2, this.querySelector('.content'), this.innerHTML)
        contentEl = this.querySelector('.content') || appendEl('content');
        contentEl.innerHTML = data.contents;
      }
      if (data.actions !== undefined) {
        console.log(3, this.querySelector('.actions'), this.innerHTML)
        actionsEl = this.querySelector('.actions') || appendEl('actions');
        actionsEl.innerHTML = '';
        for (var key in data.actions) {
          let buttonEl = document.createElement('button');
          buttonEl.innerHTML = key;
          buttonEl.addEventListener('click', _ => {
            data.actions[key]();
            this.close();
          });
          actionsEl.appendChild(buttonEl);
        }
      }
    }
  }
  
  customElements.define('a-dialog', Dialog);
})();
</script><!--
  https://material.io/guidelines/components/expansion-panels.html#
-->
<template for="ExpansionPanel">
  <style id="an-expansion-panel-style">
    an-expansion-panel {
      display: block;
      border-radius: 2px;
      z-index: 2;
      background-color: var(--theme-color-0);
      box-shadow: var(--theme-shadow-2dp);
      margin: 16px 0px;
    }
    an-expansion-panel:not([collapsed]) {
      transition: all 450ms var(--theme-animation-ease);
    }

    an-expansion-panel .title {
      position: relative;
      padding: 20px 24px;
      height: 64px;
      cursor: pointer;
    }
    an-expansion-panel .title:after {
      content: '\e5ce';
      display: inline-block;
      position: absolute;
      font-family: 'Material Icons';
      right: 24px;
      font-size: 24px;
    }
    an-expansion-panel .title h1, an-expansion-panel .title h2, an-expansion-panel .title h3 {
      font-size: var(--theme-title-font-size);
      font-weight: var(--theme-title-font-weight);
      margin: 0;
      min-width: 148px;
      font-weight: normal;
      display: inline-block;
    }
    an-expansion-panel .title > div {
      padding-left: 16px;
      display: inline-block;
    }
    an-expansion-panel .title .indicator {
      display: inline-block;
    }

    an-expansion-panel .text {
      padding: 0 24px 16px 24px;
      font-size: 14px;
      color: var(--theme-text-color-700, #444444);
    }

    an-expansion-panel .actions {
      padding: 16px 8px 16px 24px;
      font-size: 14px;
      height: 68px;
      text-align: right;
      line-height: 32px;
    }
    an-expansion-panel .actions > * {
      margin-left: 8px;
      display: inline-block;
      height: 32px;
      line-height: 32px;
    }

    an-expansion-panel[collapsed]:first-child {
      border-radius: 2px 2px 0 0;
    }
    an-expansion-panel[collapsed]:last-child {
      border-radius: 0 0 2px 2px;
    }

    an-expansion-panel[collapsed] {
      border-radius: 0;
      margin: 0;
      border-bottom: 1px solid var(--theme-text-color-100);
      max-height: 48px;
      overflow: hidden;
    }
    an-expansion-panel[collapsed] .title {
      position: relative;
      padding: 0 24px;
      line-height: 48px;
    }
    an-expansion-panel[collapsed] .title:after {
      content: '\e5cf';
    }
    an-expansion-panel[collapsed] .text,
    an-expansion-panel[collapsed] .actions {
      line-height: 0;
      padding: 0;
      overflow: hidden;
    }

  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class ExpansionPanel extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=ExpansionPanel]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      let titleEl = this.querySelector('.title');
      titleEl.addEventListener('click', this._showThisPanelOnly.bind(this));
    }

    connectedCallback() {}
    disconnectedCallback() {}

    _showThisPanelOnly(event) {
      Array.from(document.querySelectorAll('an-expansion-panel')).forEach(panelEl => {
        this.removeAttribute('collapsed');
        !panelEl.isSameNode(this) && panelEl.setAttribute('collapsed','');
      })
    }

  }
  
  customElements.define('an-expansion-panel', ExpansionPanel);
})();
</script><!--
  https://material.io/guidelines/components/grid-lists.html#grid-lists-specs
-->
<template for="GridList">
  <style id="a-grid-list-style">
    a-grid-list {
      display: block;
      text-align: center;
    }

    a-grid-list > div {
      display: inline-block;
      position: relative;
      width: 50%;
      max-width: 180px;
      height: 230px;
    } 

    a-grid-list > div img {
      max-width: 100%;
      max-height: 100%;
      height: auto
    }

    a-grid-list > div .text-with-icon {
      position: absolute;
      background-color: rgba(0,0,0,0.5);
      color: var(--theme-text-color-0);
      width: 100%;
    }

    a-grid-list > div .text-with-icon .text {
      padding: 16px;
      font-size: 12px;
      text-align: left;
    }

    a-grid-list > div .text-with-icon .text > h1,
    a-grid-list > div .text-with-icon .text > h2,
    a-grid-list > div .text-with-icon .text > h3 {
      font-size: 14px;
      margin: 0 0 6px 0;
    }

    a-grid-list > div .text-with-icon > h1,
    a-grid-list > div .text-with-icon > h2,
    a-grid-list > div .text-with-icon > h3 {
      text-align: left;
      padding: 16px;
      font-size: 14px;
      margin: 0;
    }

    a-grid-list > div .text-with-icon [md-icon],
    a-grid-list > div .text-with-icon .md-icon,
    a-grid-list > div .text-with-icon .icon {
      height: 24px;
      top: 50%;
      position: absolute;
      right: 12px;
      margin-top: -12px;
      line-height: 24px;
    }

    a-grid-list > div .text-with-icon.top {
      top: 0;
      bottom: inherit;
    }

    a-grid-list > div .text-with-icon:not(.top) {
      bottom: 0;
      top: inherit;
    }
  </style>
</template>

<script>
(function() {
  var thisScript = document.currentScript;

  class GridList extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=GridList]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
    }

    connectedCallback() {}
    disconnectedCallback() {}
  }
  
  customElements.define('a-grid-list', GridList);
})();
</script><!--
  https://material.io/guidelines/style/icons.html
-->
<template for="Icon">
  <link rel="stylesheet" href="../components/common.css">
  <style id="an-icon-style">
    an-icon {
      color: var(--theme-text-color-500, #9e9e9e);
      font-family: 'Material Icons';
      font-weight: normal;
      font-style: normal;
      font-size: 24px;
      line-height: 1;
      letter-spacing: normal;
      text-transform: none;
      display: inline-block;
      white-space: nowrap;
      word-wrap: normal;
      direction: ltr;
      -webkit-font-feature-settings: 'liga';
      -webkit-font-smoothing: antialiased;
      user-select: none;
      vertical-align: middle;
    }
    an-icon[small] { font-size: 18px; }
    an-icon[big] { font-size: 36px; }
    an-icon[double] { font-size: 48px; }
    an-icon[circle] {border-radius: 50%;}
    an-icon[square] {border-radius: 10%;}

    an-icon[circle], 
    an-icon[square] { background-color: #eee; padding: 12px; } 
    an-icon[circle][dark-bg], 
    an-icon[square][dark-bg] { 
      background-color: var(--theme-color-500, #9e9e9e);
      color: var(--theme-color-0, #ffffff);
    }
    an-icon[circle][small],
    an-icon[square][small]   { padding: 8px;} 
    an-icon[circle][big],
    an-icon[square][big]     { padding: 18px;} 

    an-icon[reactive]:active:after { animation: ripple .4s ease-out; }

    an-icon[disabled] { color: var(--theme-text-color-400, #b9b9b9); }

    an-icon[dark-bg] { background-color: var(--theme-color-800, #333333); }
    an-icon[dark-bg][disabled] { color: var(--theme-text-color-600, #727272); }

    an-icon[reactive] { position: relative; }
    an-icon[reactive]:active    { color: var(--theme-text-color-900, #202020); }
    an-icon[reactive]:hover     { color: var(--theme-text-color-600, #727272); }
    an-icon[reactive][dark-bg]:active    { color: var(--theme-text-color-0, #ffffff);   }
    an-icon[reactive][dark-bg]:hover     { color: var(--theme-text-color-300, #c2c2c2); }
    an-icon[reactive]:after {
      content: '';
      display: block;
      position: absolute;
      left: 50%;
      top: 50%;
      width: 60px;
      height: 60px;
      margin-left: -30px;
      margin-top: -30px;
      background: #3f51b5;
      border-radius: 100%;
      opacity: .6;
      visibility: hidden;
      transform: scale(0);
    }
    an-icon[reactive]:active:after { 
      visibility: visible;
      animation: ripple .4s ease-out;
    }
    an-icon[img] {
      color: transparent !important;
      background-size: cover;
      border-radius: 50%;
    }
  </style>
</template>
<script>
( function() {
  var thisScript = document.currentScript;

  class Icon extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Icon]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
    }

    connectedCallback() {
      let img = this.getAttribute('img');
      if (img) {
        this.style.backgroundImage = `url(${img})`;
        this.innerHTML = 'favorite';
      }
    }
    disconnectedCallback() {}
  }

  customElements.define('an-icon', Icon);
})();
</script>
<!--
  https://material.io/guidelines/components/lists.html#lists-specs
-->
<template for="List">
  <style id="a-list-style">
    a-list {
      display: block;
    }
    a-list ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    a-list ul li {
      list-style-type: none;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      min-height: 48px;
      border-bottom: 1px solid #ccc;
    }
    a-list ul li > .icon:first-child,
    a-list ul li > an-icon:first-child,
    a-list ul li > [md-icon]:first-child {
      width: 72px;
    }
    a-list ul li > * {
      flex: 1;
      color: var(--theme-text-color-900, #212121);
    }
    a-list ul li > .icon,
    a-list ul li > .material-icons,
    a-list ul li > [md-icon],
    a-list ul li > an-icon {
      color: var(--theme-text-color-500, #9e9e9e);
      flex: initial;
    }
    a-list ul li .text {
      font-size: 14px;
      color: var(--theme-text-color-400, #9e9e9e);
    }
  </style>
</template>

<script>
(function() {
  var thisScript = document.currentScript;

  class List extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=List]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);
    }

    connectedCallback() {}
    disconnectedCallback() {}
  }
  
  customElements.define('a-list', List);
})();
</script><!--
  ref. 
    * https://material.io/guidelines/components/menus.html#menus-specs
    * https://material.io/components/web/catalog/menus/

  observable attribute
   * visible

  Requirements
    # observable attribute
      . visible
    # styling
      . z-index: 8
      . shadow: 1
      . padding: 8px 0px
    # positionalble: bottom-right, top-right,bottom-left(default), top-left
    # one DOM, one menu display
    # hide DOM, when DOM element clicked
    # TODO: multi-level meu
    # TODO: respond to menu item changed

  Bug: 
    # css animation is not right
-->
<template for="Menu">
  <style id="a-menu-style">
  a-menu {
    background-color: var(--theme-color-0);
    box-shadow: var(--theme-shadow-1dp);
    color: var(--theme-text-color-900);
    font-size: 16px;
    overflow-y: auto;
    padding: 8px 0px;
    position: absolute;
    z-index: 8;
  }
  a-menu:not([visible]) {
    visibility: hidden;
  }
  a-menu[visible] {
    display: block;
    visibility: visible;
  }
  a-menu[position=bottom-right] {
    right: 16px;
    top: 48px;
  }
  a-menu[position=bottom-left] {
    left: 16px;
    top: 48px;
  }
  a-menu[position=top-right] {
    right: 16px;
    bottom: 48px;
  }
  a-menu[position=top-left] {
    left: 16px;
    bottom: 48px;
  }
  a-menu hr, 
  a-menu .divider {
    display: block;
    margin: 4px 0px;
    height: 1px;
    border: 1px solid #ccc;
    border-width: 0 0 1px 0;
  }
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class Menu extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Menu]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      this.observeAttrChange('visible', this._attrChanged);
      this.hideMenu = this._hideMenu.bind(this);
    }

    connectedCallback() {
      document.addEventListener('click', this.hideMenu);
    }

    disconnectedCallback() {
      document.removeEventListener('click', this.hideMenu);
    }

    observeAttrChange(attrNames, callback) {
      var observer = new MutationObserver(mutations => {
        mutations.forEach(mutation => {
          if (mutation.type === 'attributes' && ([].concat(attrNames)).includes(mutation.attributeName)) {
            let newVal = mutation.target.getAttribute(mutation.attributeName);
            callback.apply(this, [mutation.attributeName, newVal]);
          }
        });
      });
      observer.observe(this, {attributes: true});
      return observer;
    }

    _attrChanged(attr, newVal) {
      if (newVal === '') {
        Array.from(document.querySelectorAll('a-menu')).forEach(menu => {
          (this.isSameNode(menu) === false) && menu.removeAttribute('visible');
        });
        this.justShown = true; // in case when attribute is changed by outside of this
        setTimeout(_ => this.justShown = false, 100);
      }
    }

    _hideMenu(event) {
      if (!this.justShown && !this.contains(event.target)) {
        this.removeAttribute('visible');
      }
    }

  }
  
  customElements.define('a-menu', Menu);
})();
</script><!-- 
  For nav drawer
 
  https://material.io/guidelines/patterns/navigation-drawer.html#navigation-drawer-specs
-->
<template for="NavDrawer">
  <style id="a-nav-drawer-style">
    a-nav-drawer[visible] {
      visibility: visible;
    }
    a-nav-drawer:not([visible]) {
      visibility: hidden;
    }
    a-nav-drawer .page-blocker {
      position: fixed;
      background-color: #000;
      left: 0;
      right: 0;
      bottom: 0;
      opacity: .5;
      top: 0;
      z-index: 13;
    }
    a-nav-drawer .contents {
      background-color: var(--theme-color-0);
      box-shadow: var(--theme-shadow-3dp);
      color: var(--theme-text-color-900);
      display: block;
      height: 100%; 
      left: 0;
      max-width: 320px;
      overflow: auto;
      position: fixed;
      top: 0;
      width: calc(100vw - var(--theme-height-app-bar));
      z-index: 16;
    }
    a-nav-drawer[visible] .contents {
      left: 0;
      transform: translateX(0);
      transition: var(--theme-animation-in);
    }
    a-nav-drawer:not([visible]) .contents {
      left: -241px;
      transform: translateX(0);
      transition: var(--theme-animation-out);
    }

    a-nav-drawer .contents hr, 
    a-nav-drawer .contents .divider {
      display: block;
      margin: 4px 0px;
      height: 1px;
      border: 1px solid #ccc;
      border-width: 0 0 1px 0;
    }
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class NavDrawer extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=NavDrawer]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      this.observeAttrChange('visible', this._show);
      this._regroupElements();
    }

    connectedCallback() {}
    disconnectedCallback() {}

    observeAttrChange(attrNames, callback) {
      var observer = new MutationObserver(mutations => {
        mutations.forEach(mutation => {
          if (mutation.type === 'attributes' && ([].concat(attrNames)).includes(mutation.attributeName)) {
            let newVal = mutation.target.getAttribute(mutation.attributeName);
            callback.apply(this, [mutation.attributeName, newVal]);
          }
        });
      });
      observer.observe(this, {attributes: true});
      return observer;
    }

    _regroupElements() {
      let pageBlockerEl, contentsEl;
      pageBlockerEl = document.createElement('div');
      pageBlockerEl.setAttribute('class', 'page-blocker');
      pageBlockerEl.addEventListener('click', () => {
        this.removeAttribute('visible');
        this._show();
      });
      this.appendChild(pageBlockerEl);

      contentsEl = document.createElement('div');
      contentsEl.setAttribute('class', 'contents');
      this.appendChild(contentsEl);

      Array.from(this.children).forEach(el => {
        if (el.tagName !== 'STYLE' && !el.isSameNode(contentsEl) && !el.isSameNode(pageBlockerEl)) {
          contentsEl.appendChild(el)
        }
      });
    }

    _show() {
      let visible = this.getAttribute('visible') !== null;
      document.body.style.overflow = visible ? 'hidden' : '';
    }

  }
  
  customElements.define('a-nav-drawer', NavDrawer);
})();
</script><template for="NavItem">
  <style id="a-nav-item-style">
    a-nav-item {
      display: block;
      color: var(--theme-text-color-900, #333333); 
    }
    a-nav-item[disabled] {
      color: var(--theme-color-400);
      pointer-events: none;
    }

    /**
      For menu items  
      
      https://material.io/guidelines/components/menus.html#menus-specs
      https://material.io/components/web/catalog/menus/

      . must display icon, text, on the left and shortcut on the right
      . must have hover effect
      . must to have click effect
      . when disabled
        . must not have hover effect
        . must not have click effect
     */
    a-menu a-nav-item {
      line-height: 32px;
      padding: 8px 16px;
      font-size: 16px;
      display: block;
    }
    a-menu a-nav-item img {
      height: 16px;
    }
    a-menu a-nav-item:hover {
      background-color: var(--theme-color-200);
    }
    a-menu a-nav-item:active {
      background-color: var(--theme-color-50);
    }
    a-menu a-nav-item [md-icon] {
      vertical-align: middle;
      padding: 0 8px 0 0;
    }
    a-menu a-nav-item #shortcut {
      padding-left: 16px;
      float: right;
    }

    /**
       For bottom nav bar
       
       https://material.io/guidelines/components/bottom-navigation.html#bottom-navigation-specs
     */
    a-bottom-nav-bar a-nav-item {
      display: inline-block;
      font-size: 16px;
      text-align: center;
    }
    a-bottom-nav-bar a-nav-item[active] {
      padding: 6px 12px 10px 12px;
      font-size: 14px;
    }
    a-bottom-nav-bar a-nav-item:not([active]) {
      padding: 8px 12px;
      font-size: 12px;
    }
    a-bottom-nav-bar a-nav-item [md-icon] {
      display: block;
    }

    /**
      For nav drawer
      https://material.io/guidelines/patterns/navigation-drawer.html#navigation-drawer-specs
     */
    a-nav-drawer a-nav-item {
      line-height: 24px;
      font-size: 14px;
      padding: 8px 16px;
    }
    a-nav-drawer a-nav-item:hover {
      background-color: var(--theme-color-200);
    }
    a-nav-drawer a-nav-item:active {
      background-color: var(--theme-color-50);
    }
    a-nav-drawer a-nav-item .subheader {
      color: var(--theme-text-color-500);
    }
    a-nav-drawer a-nav-item [md-icon] {
      padding-right: 32px;
      color: var(--theme-text-color-500);
      vertical-align: middle;
    }

    /**
      For tabs
      https://material.io/guidelines/patterns/navigation-drawer.html#navigation-drawer-specs
     */
    a-tabs > a-nav-item {
      max-width: 264px;
      min-width: 72px; /* 160px for larger views */
      text-align: center;
    }
    a-tabs > a-nav-item[active] [md-icon],
    a-tabs > a-nav-item .text {
      color: var(--theme-text-color-200);
    }
    a-tabs > a-nav-item[active] .text {
      color: var(--theme-text-color-0);
    }
    a-tabs > a-nav-item [md-icon] {
      padding: 12px 0;
      color: var(--theme-text-color-0);
      display: block;
    }
    a-tabs > a-nav-item .text {
      display: block;
      padding: 18px 12px 20px 12px;
      text-transform: uppercase;
      vertical-align: bottom;
      font-size: 14px;
    }
    a-tabs > a-nav-item [md-icon] ~ .text {
      display: block;
      margin-top: -4px;
      padding-top: 0px;
      padding-bottom: 16px;
    }
    a-tabs > a-nav-item:after {
      content: '';
      display: block;
      position: absolute;
      left: 50%;
      top: 50%;
      width: 120px;
      height: 120px;
      margin-left: -60px;
      margin-top: -60px;
      background: #3f51b5;
      border-radius: 100%;
      opacity: .6;
      visibility: hidden;
      transform: scale(0);
    }
    a-tabs a-nav-item:active:after {
      animation: ripple 1s ease-out;
    }
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class NavItem extends HTMLElement {
    constructor() {
      super();
      if (this.innerHTML) {
        this.innerHTML=`<span class='text'>${this.innerHTML}</span>`;
      }
      let template = thisScript.ownerDocument.querySelector('template[for=NavItem]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      this.addEventListener('click', this.setActiveItem.bind(this));
    }

    connectedCallback() {
      this.icon = this.getAttribute('icon');
      this.shortcut = this.getAttribute('shortcut');
      if (this.icon) {
        let isMDIcon = this.icon.match(/^[a-z_]+$/);
        this.iconEl = document.createElement('div');
        this.iconEl.setAttribute('id', 'icon');
        if (isMDIcon) {
          this.iconEl.setAttribute('md-icon', '');
          this.iconEl.innerHTML = this.icon;
        } else {
          this.iconEl.insertAdjacentHTML('beforeend', '<img src="'+this.icon+'" />')
        }
        this.insertBefore(this.iconEl, this.firstChild)
      }
      if (this.shortcut) {
        this.shortcutEl = document.createElement('div');
        this.shortcutEl.setAttribute('id', 'shortcut');
        this.shortcutEl.innerHTML = this.shortcut;
        this.appendChild(this.shortcutEl);
      }
    }

    setActiveItem(event) {
      Array.from(this.parentElement.querySelectorAll('a-nav-item')).forEach(el => el.removeAttribute('active'));
      this.setAttribute('active', '');
    }
  }
  
  customElements.define('a-nav-item', NavItem);
})();
</script><template for="RefreshIndicator">
  <style id="a-refresh-indicator-style">
    a-refresh-indicator {
      width: 56px;
      height: 56px;
      text-align: center;
      line-height: 56px;
      border-radius: 50%;
      padding: 0;
      box-shadow: var(--theme-shadow-2dp);
      z-index: 3;
      display: inline-block;
    }
    a-refresh-indicator svg {
      width: 40px; 
      height: 40px;
      vertical-align: middle;
    }
    a-refresh-indicator.color-reversed svg circle {
      stroke: var(--theme-color-0); 
    }
    a-refresh-indicator.color-reversed svg polygon {
      fill: var(--theme-color-0); 
    }
    a-refresh-indicator[loading] svg {
      animation: rotate 1.4s infinite linear;
    }
    a-refresh-indicator[mini] {
      width: 40px;
      height: 40px;
      line-height: 40px;
    }
    a-refresh-indicator[mini] svg {
      width: 32px; 
      height: 32px;
    }
    a-refresh-indicator svg circle {
      stroke-dasharray: 44.2336, 200;
      stroke-dashoffset: -15;
      stroke: var(--theme-color-500); 
      stroke-linecap: round;
      opacity: 1; 
      stroke-width: 3; 
      fill: none; 
      transition: all 750ms ease-in-out 0ms;
    }
    a-refresh-indicator svg polygon {
      fill: var(--theme-color-500); 
      transform: rotate(314deg);
      transform-origin: 16px 16px 0px;
      opacity: 1;
    }
  </style>
  <svg viewBox="0 0 32 32">
    <circle cx="16" cy="16" r="11"></circle>
    <polygon points="21.75,16 32.25,16 27,21.25"></polygon>
  </svg>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class RefreshIndicator extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=RefreshIndicator]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      let svg = template.content.querySelector('svg').cloneNode(true);
      this.appendChild(svg);
    }

    connectedCallback() {}
    disconnectedCallback() {}
  }
  
  customElements.define('a-refresh-indicator', RefreshIndicator);
})();
</script><!--
  https://material.io/guidelines/components/text-fields.html
-->
<template for="Tabs">
  <style id="a-tabs-style">
    a-tabs {
      position: relative;
      background-color: var(--theme-color-500);
      border-radius: 2px;
      bottom: 0;
      color: var(--theme-color-900);
      display: flex;
      font-size: 0px;
      justify-content: space-between;
      width: 100%;
    }
    a-tabs > * {
      flex: 1;
    }
    a-tabs > .indicator {
      position: absolute;
      bottom: 0px;
      height: 2px;
      background-color: var(--theme-color-accent, #fff);
      left: 0%;
    }
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class Tabs extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Tabs]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      this.indicatorEl = this._addIndicatorEl();
      this._registerNavItemClick();
      this._animateIndicator();
    }

    connectedCallback() {}
    disconnectedCallback() {}

    _addIndicatorEl() {
      let el = document.createElement('div');
      let thisWidth  = this.getBoundingClientRect().width;
      let left = (
          (this.querySelector('a-nav-item[active]') || this).getBoundingClientRect().left
          - this.getBoundingClientRect().left
        ) / thisWidth;

      el.classList.add('indicator');
      el.style.left = left*100 + '%';
      this.appendChild(el);
      return el;
    }

    _registerNavItemClick() {
      Array.from(this.querySelectorAll('a-nav-item')).forEach(navItem => {
        navItem.addEventListener('click', this._animateIndicator.bind(this));
      })
    }

    /**
     * common function for Javascript animation
     */
    _animateCommon({duration, draw, timing}) {
    
      let start = performance.now();
    
      requestAnimationFrame(function animate(time) {
        let timeFraction = (time - start) / duration;
        if (timeFraction > 1) timeFraction = 1;
    
        let progress = timing(timeFraction)
    
        draw(progress);
    
        if (timeFraction < 1) {
          requestAnimationFrame(animate);
        }
      });
    }
    
    /**
     * animate the indicator below the active tab
     */
    _animateIndicator() {
      let indicatorEl = this.indicatorEl;
      let numTab = this.querySelectorAll('a-nav-item').length;
      let thisWidth  = this.getBoundingClientRect().width;
      let indicatorLeftFrom = parseFloat(indicatorEl.style.left);
      let indicatorLeftTo = (
          (this.querySelector('a-nav-item[active]') || this).getBoundingClientRect().left
          - this.getBoundingClientRect().left
        ) / thisWidth;
      let move = indicatorLeftTo*100 - indicatorLeftFrom;

      indicatorEl.style.width = parseFloat(100/numTab) + '%';

      this._animateCommon({
        duration: 450,
        timing: function(timeFraction) {
          return 1 - Math.sin(Math.acos(timeFraction));
        },
        draw: function(progress) {
          indicatorEl.style.left = indicatorLeftFrom + (progress*move) + '%';
        }
      });
    }
  
  }
  
  customElements.define('a-tabs', Tabs);
})();
</script>
<!--
  https://material.io/guidelines/components/text-fields.html#text-fields-principles

  TODO: list attribute and <datalist> support

  root level status
    disabled / empty / invalid / active / dirty

  attributes
    * disabled
    * icon="favorite"
    * label="this is label"
    * length-error="invalid text length"
    * maxlength -> word-counter
    * minlength -> word-counter
    * optional="(optional)"
    * pattern-error="invalid text pattern"
    * pattern=""
    * placeholder="this is hint text"
    * prefix="$"
    * readonly
    * required="this field is required"
    * suffix="dollars"

 Example

 <a-text-field disabled
   icon="favorite"
   helper-text="this is helper text"
   label="this is label"
   maxlength -> word-counter
   minlength -> word-counter
   minlength-error="invalid text min. length"
   maxlength-error="invalid text max. length"
   optional="(optional)"
   pattern-error="invalid text pattern"
   pattern=""
   placeholder="this is hint text"
   prefix="$"
   readonly
   required="this field is required"
   suffix="dollars"></a-text-field>
-->
<template for="TextField">
  <style id="a-text-field-style">
    a-text-field {
      display: inline-block;
      min-width: 258px;
      height: 84px;
    }
    a-text-field.full-width {
      width: 100%;
    }

    a-text-field label {
      top: 38px;
      font-size: inherit;
      position: absolute;
      transition: all 450ms var(--theme-animation-ease);
      z-index: 1; 
      transform: scale(1) translate(0px, 0px);
      transform-origin: left top 0px;
      pointer-events: none;
      user-select: none;
      color: var(--theme-text-color-700);
    }

    a-text-field .container {
      font-size: 16px;
      line-height: 24px;
      height: 84px;
      display: inline-block;
      position: relative;
      background-color: transparent;
      transition: height 200ms var(--theme-animation-ease);
      width: 100%;
    }

    a-text-field .input-wrapper {
      width: 100%;
      padding: 0px;
      position: absolute;
      bottom: 24px;
      display: flex;
    }

    a-text-field .prefix {
      color: var(--theme-text-color-500);
      padding-right: 8px;
    }

    a-text-field .suffix {
      padding-left: 8px;
      color: var(--theme-text-color-500);
    }

    a-text-field input {
      flex: 1;
      padding: 0px;
      width: 100%;
      border: none;
      outline: none; 
      background-color: transparent; 
      color: var(--theme-text-color-900);
      cursor: inherit;
      font-style: inherit;
      font-variant: inherit;
      font-weight: inherit;
      font-stretch: inherit;
      font-size: inherit;
      line-height: inherit;
      font-family: inherit;
      opacity: 1;
      -webkit-tap-highlight-color: transparent;
      box-sizing: border-box;
    }

    a-text-field hr {
      border: 2px solid var(--theme-color-800);
      border-width: 0 0 2px 0;
      bottom: 20px;
      margin: 0px;
      position: absolute;
      width: 100%;
      transform: scaleX(1);
      transition: all 450ms var(--theme-animation-ease);
    }
    a-text-field .helper-text {
      position: absolute;
      bottom: 0;
      font-size: 12px;
      line-height: 12px;
      color: var(--theme-text-color-600);
      transition: all 450ms var(--theme-animation-ease) 0ms;
    }
    a-text-field .error-messages {
      position: absolute;
      bottom: 0px;
      width: 100%;
      font-size: 12px;
      line-height: 12px;
      background-color: var(--theme-color-0);
      transition: all 450ms var(--theme-animation-ease) 0ms;
    }

    /* disabled / empty / invalid / active */
    a-text-field[empty]:not([active]) .input-wrapper {
      visibility: hidden;
    }

    a-text-field:not([empty]) label,
    a-text-field[empty][active] label {
      top: 12px;
      font-size: 12px;
    }

    a-text-field[disabled] {
      pointer-events: none;
    }
    a-text-field[disabled] label,
    a-text-field[disabled] .prefix,
    a-text-field[disabled] .suffix,
    a-text-field[disabled] input,
    a-text-field[disabled] hr,
    a-text-field[disabled] .helper-text,
    a-text-field[disabled] .error-messages,
    a-text-field[disabled] [md-icon]:not(:empty) {
      color: var(--theme-text-color-500);
    }
    a-text-field[disabled] hr {
      border-color: var(--theme-color-500);
    }

    a-text-field[invalid] label,
    a-text-field[invalid] hr,
    a-text-field[invalid] .helper-text,
    a-text-field[invalid] .error-messages,
    a-text-field[invalid] [md-icon]:not(:empty) {
      color: var(--theme-color-error);
    }
    a-text-field[disabled] hr {
      border-color: var(--theme-color-erroor);
    }
    a-text-field:not([invalid]) .error-messages {
      visibility: hidden;
    }

    a-text-field:not([empty], [active]) .suffix,
    a-text-field:not([empty], [active]) .prefix,
    a-text-field[disabled] input {
      display: inherit;
    }
    a-text-field [md-icon]:empty,
    a-text-field label:empty,
    a-text-field .prefix:empty,
    a-text-field .suffix:empty,
    a-text-field .helper-text:empty,
    a-text-field .error-messages:empty {
      display: none;
    }

    a-text-field [md-icon]:not(:empty) {
      color: var(--theme-text-color-700);
      position: relative;
      bottom: 22px;
    }

    a-text-field [md-icon]:not(:empty) ~ .container {
      width: calc(100% - 40px);
    }


  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class TextField extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=TextField]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      this.id = 'a-text-field-'+Math.round(Math.random()*10**9);
      this._buildHTML();
    }

    get disabled() {
      return this.getAttribute('disabled') !== '';
    }

    set disabled(disabled) {
      disabled ? this.setAttribute('disabled', '') : this.removeAttribute('disabled');
    }

    get errorMessages() {
      let errorMessages = this.__cachedErrorMessages || {
        rangeUnderflow: this.getAttribute('min-error') || 'invalid min. value',
        rangeOverflow: this.getAttribute('max-error') || 'invalid max. value',
        stepMismatch: this.getAttribute('step-error') || 'invalid value(step)',
        tooShort:  this.getAttribute('minlength-error') || 'invalid min. length',
        tooLong: this.getAttribute('maxlength-error') || 'invalid max. length',
        patternMismatch: this.getAttribute('pattern-error') || 'invalid input text',
        valueMissing: this.getAttribute('required-error') || 'this field is requierd',
        typeMismatch: this.getAttribute('type-error') ||
          'invalid input for type, '+this.getAttribute('type'),
        customError: this.getAttribute('custom-error') || 'invaid input(custom error)',
        invalidError: this.getAttribute('invalid-error') || 'invaid input'
      }
      this.__cachedErrorMessages = errorMessages;
      return errorMessages;
    }

    connectedCallback() {
      this.inputEl = this.querySelector('#'+this.id);
      this._addEventListeners();
    }

    _buildHTML() {
      let icon = this.getAttribute('icon') || '';
      let type = this.getAttribute('type') || 'text';
      let hintText = this.getAttribute('placeholder') || '';
      let helpetText = this.getAttribute('helper-text') || '';
      let label = this.getAttribute('label') || '';
      let prefix = this.getAttribute('prefix') || '';
      let suffix = this.getAttribute('suffix') || '';
      let optionalText = this.getAttribute('optional') || '';
      let helperText = this.getAttribute('helper-text') || '';
      let requiredText = this.getAttribute('required') !== null ? ' *' : '';

      let attrs = [];
      for (let i=0; i<this.attributes.length; i++) {
        let attr = this.attributes[i];
        (!attr.name.match(/-/)) && attrs.push(`${attr.name}="${attr.value}"`);
      }
      let attributes = attrs.join(' ');

      let html = `
        <i class="icon" md-icon>${icon}</i>
        <div class="container">
          <label for="${this.id}" style="">${label}${optionalText}${requiredText}</label>
          <div class="input-wrapper">
            <div class="prefix">${prefix}</div>
            <input class="input" type="${type}" id="${this.id}" ${attributes} />
            <div class="suffix">${suffix}</div>
          </div>
          <hr />
          <div class="helper-text">${helperText}</div>
          <div class="error-messages"></div>
        </div>
      `;
      this.insertAdjacentHTML('beforeend', html);
    }

    _getErrors() {
      let errors = {};
      for (var key in this.inputEl.validity) {
        if (key !== 'valid' && this.inputEl.validity[key]) {
          errors[key] = this.errorMessages[key];
        }
      }
      if (this.getAttribute('maxlength')) {
        let tooLong = this.inputEl.value.length > parseInt(this.getAttribute('maxLength'));
        tooLong && (errors.tooLong = this.errorMessages.tooLong);
      }
      return errors;
    }

    _addEventListeners() {
      let setStatus = () => {
        let empty  = !this.inputEl.value;
        let error = Object.values(this._getErrors())[0];
        let errMsgEl = this.querySelector('.error-messages');
        let dirty = this.getAttribute('dirty') !== null;

        empty ? this.setAttribute('empty', '')   : this.removeAttribute('empty');
        if (dirty && error) {
          this.setAttribute('invalid', ''); 
          errMsgEl.innerHTML = error;
        } else {
          this.removeAttribute('invalid')
        }
      }

      setStatus();

      this.addEventListener('click', event => {
        this.setAttribute('active', '');
        this.inputEl.focus();
      });

      this.inputEl.addEventListener('blur', event => {
        this.removeAttribute('active');
      });

      this.inputEl.addEventListener('change', event => {
        this.setAttribute('dirty', '');
        setStatus();
      });
    }
  }
  
  customElements.define('a-text-field', TextField);
})();
</script>
<!--
  https://material.io/guidelines/components/tooltips.html#tooltips-tooltips-mobile
-->
<template for="Tooltip">
  <style id="a-tooltip-style">
    a-tooltip {
      position: absolute;
      visibility: hidden;
      background: var(--theme-color-600, #757575);
      color: #fff;
      line-height: 32px;
      font-size: 14px;
      padding: 0 16px;
      border-radius: 2px;
      white-space: nowrap;
    }
    a-tooltip.visible {
      visibility: visible;
      transition: all .2s ease .5s;
      z-index: 24;
    }
  </style>
</template>

<script>
( function() {
  var thisScript = document.currentScript;

  class Tooltip extends HTMLElement {
    constructor() {
      super();
      let template = thisScript.ownerDocument.querySelector('template[for=Tooltip]');
      let style = template.content.querySelector('style').cloneNode(true);
      !document.getElementById(style.id) && document.head.appendChild(style);

      this.originalPos = {parent: this.parentElement, nextSibling: this.nextElementSibling};
      this._addEventListeners();
    }

    connectedCallback() {}
    disconnectedCallback() {}

    _addEventListeners() {
      this.parentElement.addEventListener('mouseenter', _ => {
        this._showTooltip();
      });
      this.parentElement.addEventListener('mouseleave', _ => {
        this.classList.remove('visible');
        this.originalPos.parent.insertBefore(this, this.originalPos.nextSibling);
      });
    }

    _showTooltip() {
      let parentBCR = this.parentElement.getBoundingClientRect(); // relative to viewport
      let body = document.body;
      let docEl = document.documentElement;

      let scrollTop = window.pageYOffset || docEl.scrollTop || body.scrollTop;
      let scrollLeft = window.pageXOffset || docEl.scrollLeft || body.scrollLeft;

      let clientTop = docEl.clientTop || body.clientTop || 0;
      let clientLeft = docEl.clientLeft || body.clientLeft || 0;

      let docPosTop = Math.round(parentBCR.top +  scrollTop - clientTop);
      let docPosLeft = Math.round(parentBCR.left + scrollLeft - clientLeft);

      let top = docPosTop + parentBCR.height + 24;

      this.style.top = top + 'px';
      this.style.left = '';
      this.style.right = '';

      document.body.appendChild(this);
      setTimeout(_ => {
        let thisBCR = this.getBoundingClientRect(); // it needs time to calc this properly
        let left = docPosLeft + (parentBCR.width / 2) - (thisBCR.width / 2);

        if (left < 8) {
          this.style.left = '8px';
        } else if (left + thisBCR.width > document.body.clientWidth) {
          this.style.right = '8px';
        } else {
          this.style.left = left + 'px';
        }

        this.classList.add('visible')
      }, 100);
    }
  }

  customElements.define('a-tooltip', Tooltip);
})();
</script>
