<!doctype html>
<!-- This page is useful for development and testing. As of. Nov 2017. This page works well with Chrome browser. -->
<html>
  <head>
    <meta name="viewport" content="initial-scale=1, width=device-width">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900italic,900">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.7.4/beautify-html.js"></script>
    <script src="https://unpkg.com/code-prettify@0.1.0/src/run_prettify.js"></script>
    <link rel="import" href="../theme.tmpl.html" />

    <link rel="stylesheet" class="theme" href="../../themes/grey.css">
    <style>
      body { font-family: 'Roboto'; margin: 0; color: var(--theme-text-color-900, #212121); background-color: var(--theme-color-50, #FAFAFA); }
      *, *:before, *:after { box-sizing: border-box; }
      .container { padding: 12px; }
      .dark-bg { background-color: var(--theme-color-600, #757575); color: var(--theme-text-color-0, #ffffff); }
      .clear-both:after { visibility: hidden; display: block; font-size: 0; content: " "; clear: both; height: 0; }
      .float-right { float: right; }

      .demo { position: relative; }
      .view-source ~ label { padding: 12px 0; display: inline-block; }
      .view-source ~ .code { max-height: 0; overflow: hidden; border: none; margin: 0; transition: all .4s ease-out;}
      .view-source[checked] ~ .code { max-height: 999px;  transition: all 1s ease-out; overflow: auto;}
    </style>
    <script>
      function setDemo(src, dest) {
        var html = document.querySelector(src).content.cloneNode(true).querySelector('*').outerHTML;
        document.querySelector(dest+' .demo').innerHTML = html;
        document.querySelector(dest+' .code').innerHTML = html_beautify(html, {indent_size: 2}).replace(/</g,'\&lt;');
      }
    </script>

    <script type="module" src="../router/main.js"></script>

    <script type="module" src="../card/main.js"></script>
    <link rel="stylesheet" class="card" href="../card/style.css">

    <script type="module" src="../switch/main.js"></script>
    <link rel="stylesheet" class="switch" href="../switch/style.css">

    <script type="module" src="../list/main.js"></script>
    <link rel="stylesheet" class="list" href="../list/style.css">

    <script type="module" src="../menu/main.js"></script>
    <link rel="stylesheet" class="menu" href="../menu/style.css">

    <link rel="stylesheet" class="icon" href="../icon/style.css">
    <link rel="stylesheet" class="nav-item" href="../nav-item/style.css">
  </head>
  <body>

    <template class="simple">
      <a-router>
        <a-route path="/page1" import="page1.html" no-cache></a-route>
        <a-route path="/page2" import="page2.html"></a-route>
        <a-route path="not-found" import="not-found.html"></a-route>
        <a-route path="" redirect="/page1"></a-route>
      </a-router>
    </template>

    <template class="callbacks">
      <a-router
        base-path="/base/path"
        resolve-func="fn.routerResolve"
        on-http-start="fn.onHttpStart"
        on-http-end="fn.onHttpEnd">
        <a-route path="/page1" import="page1.html" no-cache
          resolve-func="fn.routeResolve"
          on-route-start="fn.onRouteStart"
          on-route-end="fn.onRouteEnd"></a-route>
        <a-route path="/page2" import="page2.html"></a-route>
        <a-route path="/not-found" import="not-found.html"></a-route>
        <a-route path="" redirect="/page1"></a-route>
      </a-router>
    </template>
    <script>
      function getPromiseFn(str, ret) {
        return function(param) {
          console.log('starting function', str, 'with parameter', param);
          return new Promise(function(resolve, reject) {
            setTimeout(function() { resolve(ret); }, 1000);
          });
        }
      };
      var fn = {
        routerResolve : getPromiseFn('routerResolveFn', {data:'router'}),
        onHttpStart   : getPromiseFn('onHTTPStartFn', {method: 'GET'}),
        onHttpEnd     : getPromiseFn('onHTTPEndFn', {method: 'GET'}),
        routeResolve  : getPromiseFn('routeResolveFn', {data: 'route'}),
        onRouteStart  : getPromiseFn('onRouteStartFn', null),
        onRouteEnd    : getPromiseFn('onRouteEndFn', null)
      }
    </script>

    <div class="container">
      <h1>Router</h1>
      <p>
        `a-router` is an element that responds to url change.
      </p>
        a-router watches the url changes, find a proper route, and allow the route do the proper action.

      <div id="import-theme-tmpl" class="clear-both"></div>

      <h2>Installation</h2>
      <p>
        Just add the following script(< 2kb gzipped/polyfill in it) to your website.
        <pre>&lt;script defer src="https://unpkg.com/@custom-element/router">&lt;/script></pre>
      </p>

      <h2> Examples </h2>

      <a-card class="simple">
        <div class="title">
          <h2>Simple Router Example</h2>
          <p class="subtitle">
            Routing between page1 and page2
          </p>
        </div>
        <div class="text">
          <div class="demo"></div>
          <div>
            <a href="#/page1">Page1</a>
            <a href="#/page2">page2</a>
            <a href="#/invalid">Invalid</a>
          </div>
          <div>
            <a-switch id="demo-simple" class="view-source" checked></a-switch>
            <label for="demo-simple"> View Source</label>
            <pre class="code prettyprint"></pre>
          </div>
        </div>
      </a-card>
      <script>setDemo('template.simple', 'a-card.simple')</script>

      <a-card class="callbacks">
        <div class="title">
          <h2>Router Example With Callbacks</h2>
          <p class="subtitle">
            Router/Route has promise and callback functions before or after http call and route.
          </p>
        </div>
        <div class="text">
          <div class="demo"></div>
          <div>
            <a href="#/base/path/page1">Page1</a>
            <a href="#/base/path/page2">page2</a>
            <a href="#/base/path/invalid">Invalid</a>
          </div>
          <div>
            <a-switch id="demo-simple" class="view-source" checked></a-switch>
            <label for="demo-simple"> View Source</label>
            <pre class="code prettyprint"></pre>
          </div>
        </div>
      </a-card>
      <script>setDemo('template.callbacks', 'a-card.callbacks')</script>
    </div>

    <div class="container">
      <a-list>
        <ul>
          <h3>`a-router` Element Attributes</h3>
          <li> 
            <an-icon>code</an-icon>
            <div><div>base-path</div>
               <div class="text">Optional. default '/', base path of this router. All route path will be prefixed with this base path.t</div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>debug</div>
               <div class="text">Optional. if true, there will be a debug message. This attribute is monitored.</div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>resolve-func</div>
               <div class="text">Optional, router level resolve function. e.g. security check, configuration, etc </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>on-http-start</div>
               <div class="text"> Optional, injector function to be executed before all http requests calls. This can change http request. </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>on-http-end</div>
               <div class="text">Optional, injector function to be executed after all http responses. This can change http response.</div> 
            </div>
          </li>
        </ul>
      </a-list>

      <a-list>
        <ul>
          <h3>`a-route` Element Attributes</h3>
          <li> 
            <an-icon>code</an-icon>
            <div><div>path</div>
               <div class="text"><i>required</i>path to respond</div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>import</div>
               <div class="text">url to load, `import` or `redirect` is requird. </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>redirect</div>
               <div class="text"> path to redirect. `import` or `redirect` is requird. </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>template-cached</div>
              <div class="text">
                Optional, true or false,  default true. Indicates that the route view template is cached or not.
                 if true, `<a-route>` will have `<template>` as its child after first remote call.
               </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>resolve-func</div>
               <div class="text">
                 Optional, route level resolve function. e.g. data loading. The resolved data will be set to `<a-route>` element as a data. e.g. `$0.data.foo`, `$0.data.bar`
               </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>on-route-start</div>
               <div class="text">
                 Optional, injector function to be executed before route starts.
               </div> 
            </div>
          </li>
          <li> 
            <an-icon>code</an-icon>
            <div><div>on-route-end</div>
               <div class="text">
                 Optional, injector function to be executed after route ends.
               </div> 
            </div>
          </li>
        </ul>
      </a-list>
    </div>

  </body>
</html>
